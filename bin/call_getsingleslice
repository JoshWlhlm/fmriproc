#!/usr/bin/env python

import sys
import nibabel as nb

def main(argv):

    """
---------------------------------------------------------------------------------------------------
call_getsingleslice

This super short script fetches the requested volume along the last axis. The slice image will nor-
mally be 720x720x1x3, so we need to extract from the last axis.

Args:
    <input file>        string-like path to file to extract from
    <output file>       string-like path to output new volume to
    <volume nr>         n'th volume to extract from input file

Outputs
    output file         new volume containing the extracted data from input file

Example:
    call_getsingleslice input.nii.gz output.nii.gz 0

---------------------------------------------------------------------------------------------------
    """

    if len(argv) < 3:
        print(main.__doc__)
        sys.exit()

    in_file = argv[1]
    out_file = argv[2]
    vol = argv[3]

    in_data = nb.load(in_file)
    real_slice = in_data.get_fdata()[:,:,:,int(vol)]
    nb.Nifti1Image(
        real_slice,
        header=in_data.header,
        affine=in_data.affine
    ).to_filename(out_file)

if __name__ == "__main__":
    main(sys.argv[1:])
